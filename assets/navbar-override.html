<script>
  document.addEventListener('DOMContentLoaded', function () {
    const header = document.getElementById('quarto-header');
    if (!header) return;

    let lastScrollY = window.scrollY;

    // Remove existing scroll listeners
    window.removeEventListener('scroll', window._headroom_scroll_handler);

    // Add our own scroll handler
    window.addEventListener('scroll', function () {
      const currentScrollY = window.scrollY;

      if (currentScrollY === 0) {
        // At the top of the page
        header.classList.remove('headroom--pinned', 'headroom--unpinned', 'headroom--not-top');
      } else {
        if (!header.classList.contains('headroom--not-top')) {
          header.classList.add('headroom--not-top');
        }

        if (currentScrollY < lastScrollY) {
          // Scrolling up
          header.classList.remove('headroom--unpinned');
          header.classList.add('headroom--pinned');
        } else if (currentScrollY > lastScrollY) {
          // Scrolling down
          header.classList.remove('headroom--pinned');
          header.classList.add('headroom--unpinned');
        }
      }

      lastScrollY = currentScrollY;
    }, {passive: true});
  });
</script>
